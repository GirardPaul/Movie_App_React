{"ast":null,"code":"import _classCallCheck from\"/Users/girard/Documents/MovieApp/movieapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/girard/Documents/MovieApp/movieapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/girard/Documents/MovieApp/movieapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/girard/Documents/MovieApp/movieapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import SearchBar from\"../components/searchBar\";import VideoList from\"./videoList\";import axios from\"axios\";import VideoDetail from\"../components/videoDetail\";import Video from\"../components/Video\";var API_END_POINT=\"https://api.themoviedb.org/3/\";var POPULAR_MOVIES_URL=\"discover/movie?language=fr&sort_by=popularity.desc&include_adult=false&append_to_response=images\";var API_KEY=\"api_key=83c6111d367f0146a56cb5c464466b1b\";var SEARCH_URL=\"search/movie?language=fr&include_adult=false\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={movieList:{},currentMovie:{}};return _this;}//Quand le composant va être chargé\n_createClass(App,[{key:\"componentWillMount\",value:function componentWillMount(){this.initMovies();}},{key:\"initMovies\",value:function initMovies(){//Etabli la requete puis transmets la réponse à la requête dans response\naxios.get(\"\".concat(API_END_POINT).concat(POPULAR_MOVIES_URL,\"&\").concat(API_KEY)).then(function(response){//Récupère les 5 films les plus populaires à partir de l'index 1\n//Récupère le film le plus populaire\nthis.setState({movieList:response.data.results.slice(1,6),currentMovie:response.data.results[0]},function(){this.applyVideoToCurrentMovie();});console.log(this.state.movieList);console.log(this.state.currentMovie);}.bind(this));}},{key:\"applyVideoToCurrentMovie\",value:function applyVideoToCurrentMovie(){//Etabli la requete puis transmets la réponse à la requête dans response\naxios.get(\"\".concat(API_END_POINT,\"movie/\").concat(this.state.currentMovie.id,\"?\").concat(API_KEY,\"&append_to_response=videos&include_adult=false\")).then(function(response){var youtubeKey=response.data.videos.results[0].key;var newCurrentMovieState=this.state.currentMovie;newCurrentMovieState.videoId=youtubeKey;this.setState({currentMovie:newCurrentMovieState});console.log(newCurrentMovieState);}.bind(this));}},{key:\"onClickListItem\",value:function onClickListItem(movie){this.setState({currentMovie:movie},function(){this.applyVideoToCurrentMovie();this.setRecommendation();});}},{key:\"setRecommendation\",value:function setRecommendation(){axios.get(\"\".concat(API_END_POINT,\"movie/\").concat(this.state.currentMovie.id,\"/recommendations?\").concat(API_KEY,\"&language=fr\")).then(function(response){//Récupère les 5 films les plus populaires à partir de l'index 1\n//Récupère le film le plus populaire\nthis.setState({movieList:response.data.results.slice(0,5)});}.bind(this));}},{key:\"onClickSearch\",value:function onClickSearch(searchText){if(searchText){axios.get(\"\".concat(API_END_POINT).concat(SEARCH_URL,\"&\").concat(API_KEY,\"&query=\").concat(searchText)).then(function(response){var _this2=this;if(response.data&&response.data.results[0]){if(response.data.results[0].id!==this.state.currentMovie.id){this.setState({currentMovie:response.data.results[0]},function(){_this2.applyVideoToCurrentMovie();_this2.setRecommendation();});}}}.bind(this));}console.log(searchText);}},{key:\"render\",value:function render(){var _this3=this;var renderVideoList=function renderVideoList(){if(_this3.state.movieList.length>=5){return/*#__PURE__*/React.createElement(VideoList,{movieList:_this3.state.movieList,callback:_this3.onClickListItem.bind(_this3)});}};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"search_bar\"},/*#__PURE__*/React.createElement(SearchBar,{callback:this.onClickSearch.bind(this)})),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8\"},/*#__PURE__*/React.createElement(Video,{videoId:this.state.currentMovie.videoId}),/*#__PURE__*/React.createElement(VideoDetail,{title:this.state.currentMovie.title,description:this.state.currentMovie.overview,avis:this.state.currentMovie.vote_average*10})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4\"},renderVideoList())));}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/girard/Documents/MovieApp/movieapp/src/containers/App.js"],"names":["React","Component","SearchBar","VideoList","axios","VideoDetail","Video","API_END_POINT","POPULAR_MOVIES_URL","API_KEY","SEARCH_URL","App","props","state","movieList","currentMovie","initMovies","get","then","response","setState","data","results","slice","applyVideoToCurrentMovie","console","log","bind","id","youtubeKey","videos","key","newCurrentMovieState","videoId","movie","setRecommendation","searchText","renderVideoList","length","onClickListItem","onClickSearch","title","overview","vote_average"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport SearchBar from \"../components/searchBar\";\nimport VideoList from \"./videoList\";\nimport axios from \"axios\";\nimport VideoDetail from \"../components/videoDetail\";\nimport Video from \"../components/Video\";\n\nconst API_END_POINT = \"https://api.themoviedb.org/3/\";\nconst POPULAR_MOVIES_URL =\n  \"discover/movie?language=fr&sort_by=popularity.desc&include_adult=false&append_to_response=images\";\nconst API_KEY = \"api_key=83c6111d367f0146a56cb5c464466b1b\";\nconst SEARCH_URL = \"search/movie?language=fr&include_adult=false\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { movieList: {}, currentMovie: {} };\n  }\n  //Quand le composant va être chargé\n  componentWillMount() {\n    this.initMovies();\n  }\n\n  initMovies() {\n    //Etabli la requete puis transmets la réponse à la requête dans response\n    axios.get(`${API_END_POINT}${POPULAR_MOVIES_URL}&${API_KEY}`).then(\n      function (response) {\n        //Récupère les 5 films les plus populaires à partir de l'index 1\n        //Récupère le film le plus populaire\n        this.setState(\n          {\n            movieList: response.data.results.slice(1, 6),\n            currentMovie: response.data.results[0],\n          },\n          function () {\n            this.applyVideoToCurrentMovie();\n          }\n        );\n\n        console.log(this.state.movieList);\n        console.log(this.state.currentMovie);\n      }.bind(this)\n    );\n  }\n\n  applyVideoToCurrentMovie() {\n    //Etabli la requete puis transmets la réponse à la requête dans response\n    axios\n      .get(\n        `${API_END_POINT}movie/${this.state.currentMovie.id}?${API_KEY}&append_to_response=videos&include_adult=false`\n      )\n      .then(\n        function (response) {\n          const youtubeKey = response.data.videos.results[0].key;\n          let newCurrentMovieState = this.state.currentMovie;\n          newCurrentMovieState.videoId = youtubeKey;\n          this.setState({ currentMovie: newCurrentMovieState });\n\n          console.log(newCurrentMovieState);\n        }.bind(this)\n      );\n  }\n\n  onClickListItem(movie) {\n    this.setState({ currentMovie: movie }, function () {\n      this.applyVideoToCurrentMovie();\n      this.setRecommendation();\n    });\n  }\n\n  setRecommendation(){\n    axios.get(`${API_END_POINT}movie/${this.state.currentMovie.id}/recommendations?${API_KEY}&language=fr`).then(\n      function (response) {\n        //Récupère les 5 films les plus populaires à partir de l'index 1\n        //Récupère le film le plus populaire\n        this.setState(\n          {\n            movieList: response.data.results.slice(0, 5)\n          });\n      }.bind(this)\n    );\n  }\n\n  onClickSearch(searchText) {\n    if (searchText) {\n      axios\n        .get(`${API_END_POINT}${SEARCH_URL}&${API_KEY}&query=${searchText}`)\n        .then(\n          function (response) {\n            if(response.data && response.data.results[0]){\n                if(response.data.results[0].id !== this.state.currentMovie.id){\n                    this.setState({currentMovie: response.data.results[0]}, () => {\n                      this.applyVideoToCurrentMovie();\n                      this.setRecommendation();\n                    })\n                }\n            }\n           \n          }.bind(this)\n        );\n    }\n\n    console.log(searchText);\n  }\n  render() {\n    const renderVideoList = () => {\n      if (this.state.movieList.length >= 5) {\n        return (\n          <VideoList\n            movieList={this.state.movieList}\n            callback={this.onClickListItem.bind(this)}\n          />\n        );\n      }\n    };\n    return (\n      <div>\n        <div className=\"search_bar\">\n          <SearchBar callback={this.onClickSearch.bind(this)} />\n        </div>\n        <div className=\"row\">\n          <div className=\"col-md-8\">\n            <Video videoId={this.state.currentMovie.videoId} />\n            <VideoDetail\n              title={this.state.currentMovie.title}\n              description={this.state.currentMovie.overview}\n              avis={this.state.currentMovie.vote_average*10}\n            />\n          </div>\n          <div className=\"col-md-4\">{renderVideoList()}</div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}